<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>MUTECH Investment Platform</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
<style>
:root {
  --bg-dark: #0a0e27;
  --bg-light: #f6f7fb;
  --card-dark: rgba(255,255,255,0.05);
  --card-light: #ffffff;
  --accent1: #667eea;
  --accent2: #764ba2;
  --text-light: #ffffff;
  --text-dark: #1a1a2e;
}

* { margin: 0; padding: 0; box-sizing: border-box; }

body {
  font-family: 'Poppins', sans-serif;
  background: var(--bg-dark);
  color: var(--text-light);
  line-height: 1.6;
  min-height: 100vh;
  transition: background 0.3s, color 0.3s;
}

body.light-mode {
  background: var(--bg-light);
  color: var(--text-dark);
}

.container {
  max-width: 1200px;
  margin: 0 auto;
  padding: 1rem;
}

nav {
  background: linear-gradient(135deg, var(--accent1), var(--accent2));
  padding: 1rem;
  border-radius: 12px;
  margin-bottom: 1rem;
  display: flex;
  justify-content: space-between;
  align-items: center;
  flex-wrap: wrap;
  gap: 1rem;
  box-shadow: 0 8px 32px rgba(0,0,0,0.3);
}

.logo-section {
  display: flex;
  align-items: center;
  gap: 1rem;
}

.logo {
  width: 50px;
  height: 50px;
  background: linear-gradient(135deg, #ffd700, #ffed4e);
  border-radius: 12px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 1.5rem;
  font-weight: 700;
  color: var(--accent2);
  box-shadow: 0 4px 12px rgba(255,215,0,0.3);
}

.brand h1 {
  font-size: 1.5rem;
  margin: 0;
}

.brand .tagline {
  font-size: 0.85rem;
  opacity: 0.9;
}

.nav-controls {
  display: flex;
  gap: 0.5rem;
  align-items: center;
  flex-wrap: wrap;
}

.btn {
  padding: 0.6rem 1.2rem;
  border: none;
  border-radius: 8px;
  cursor: pointer;
  font-weight: 600;
  transition: all 0.3s;
  font-size: 0.9rem;
}

.btn-primary {
  background: linear-gradient(135deg, var(--accent1), var(--accent2));
  color: white;
  box-shadow: 0 4px 12px rgba(102,126,234,0.3);
}

.btn-primary:hover {
  transform: translateY(-2px);
  box-shadow: 0 6px 20px rgba(102,126,234,0.4);
}

.btn-outline {
  background: transparent;
  border: 1px solid rgba(255,255,255,0.3);
  color: white;
}

.btn-ghost {
  background: transparent;
  color: white;
}

.theme-btn {
  background: rgba(255,255,255,0.2);
  border: none;
  padding: 0.5rem;
  border-radius: 8px;
  cursor: pointer;
  font-size: 1.2rem;
  transition: all 0.3s;
}

.card {
  background: var(--card-dark);
  backdrop-filter: blur(10px);
  border-radius: 12px;
  padding: 1.5rem;
  margin-bottom: 1rem;
  border: 1px solid rgba(255,255,255,0.1);
  box-shadow: 0 8px 32px rgba(0,0,0,0.2);
}

body.light-mode .card {
  background: var(--card-light);
  border: 1px solid rgba(0,0,0,0.1);
  box-shadow: 0 4px 16px rgba(0,0,0,0.1);
}

.plans {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 1rem;
  margin: 1rem 0;
}

.plan {
  background: rgba(255,255,255,0.05);
  padding: 1.5rem;
  border-radius: 12px;
  text-align: center;
  transition: transform 0.3s;
  border: 1px solid rgba(255,255,255,0.1);
}

.plan:hover {
  transform: translateY(-5px);
}

.plan h4 {
  color: var(--accent1);
  margin-bottom: 0.5rem;
}

.stats {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
  gap: 1rem;
  margin: 1rem 0;
}

.stat-card {
  background: rgba(255,255,255,0.05);
  padding: 1rem;
  border-radius: 12px;
  text-align: center;
}

.stat-card .label {
  font-size: 0.85rem;
  opacity: 0.8;
  margin-bottom: 0.5rem;
}

.stat-card .value {
  font-size: 1.5rem;
  font-weight: 700;
  color: var(--accent1);
}

.table-wrap {
  overflow-x: auto;
  margin: 1rem 0;
}

table {
  width: 100%;
  border-collapse: collapse;
}

th, td {
  padding: 0.75rem;
  text-align: left;
  border-bottom: 1px solid rgba(255,255,255,0.1);
}

th {
  background: rgba(255,255,255,0.05);
  font-weight: 600;
}

.modal {
  display: none;
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0,0,0,0.8);
  z-index: 1000;
  align-items: center;
  justify-content: center;
  backdrop-filter: blur(5px);
}

.modal.active {
  display: flex;
}

.modal-content {
  background: var(--bg-dark);
  padding: 2rem;
  border-radius: 12px;
  max-width: 500px;
  width: 90%;
  max-height: 90vh;
  overflow-y: auto;
  box-shadow: 0 20px 60px rgba(0,0,0,0.5);
}

body.light-mode .modal-content {
  background: var(--card-light);
}

.modal-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 1.5rem;
}

.close-btn {
  background: none;
  border: none;
  font-size: 1.5rem;
  cursor: pointer;
  color: inherit;
}

.form-group {
  margin-bottom: 1rem;
}

.form-group label {
  display: block;
  margin-bottom: 0.5rem;
  font-weight: 500;
}

.form-group input,
.form-group select {
  width: 100%;
  padding: 0.75rem;
  border-radius: 8px;
  border: 1px solid rgba(255,255,255,0.2);
  background: rgba(255,255,255,0.05);
  color: inherit;
  font-family: inherit;
}

.form-group input:focus,
.form-group select:focus {
  outline: none;
  border-color: var(--accent1);
  box-shadow: 0 0 0 3px rgba(102,126,234,0.2);
}

.deposit-box {
  background: linear-gradient(135deg, rgba(102,126,234,0.1), rgba(118,75,162,0.1));
  padding: 1.5rem;
  border-radius: 12px;
  margin: 1rem 0;
  border: 1px solid rgba(102,126,234,0.3);
}

.deposit-actions {
  display: flex;
  gap: 0.5rem;
  margin-top: 1rem;
  flex-wrap: wrap;
}

.admin-item {
  background: rgba(255,255,255,0.05);
  padding: 1rem;
  border-radius: 8px;
  margin-bottom: 0.5rem;
}

.admin-actions {
  display: flex;
  gap: 0.5rem;
  margin-top: 0.5rem;
}

.hidden { display: none !important; }
.muted { opacity: 0.7; }
.small { font-size: 0.85rem; }
.mt-1 { margin-top: 1rem; }

@media (max-width: 768px) {
  nav {
    flex-direction: column;
    text-align: center;
  }
  .plans, .stats {
    grid-template-columns: 1fr;
  }
}
</style>
</head>
<body>

<div class="container">
  <nav>
    <div class="logo-section">
      <div class="logo">M</div>
      <div class="brand">
        <h1>MUTECH</h1>
        <div class="tagline">Investment Platform</div>
      </div>
    </div>
    <div class="nav-controls">
      <button class="theme-btn" id="themeToggle" title="Toggle theme">üåô</button>
      <div id="authButtons">
        <button class="btn btn-primary" id="loginBtn">Login</button>
        <button class="btn btn-outline" id="registerBtn">Register</button>
      </div>
      <div id="userInfo" class="hidden">
        <span id="username"></span>
        <button class="btn btn-ghost" id="logoutBtn">Logout</button>
        <button class="btn btn-primary hidden" id="adminBtn">Admin</button>
      </div>
    </div>
  </nav>

  <section id="landingSection">
    <div class="card">
      <h2>Welcome to MUTECH Investment Platform</h2>
      <p class="muted">Start your investment journey today. Register to explore deposits, investments, and referrals.</p>

      <div class="plans">
        <div class="plan">
          <h4>Starter</h4>
          <p>‚Ç¶5,000 - ‚Ç¶10,000</p>
          <p class="muted small">ROI: 20%</p>
          <button class="btn btn-primary plan-btn" data-plan="starter">Choose Plan</button>
        </div>
        <div class="plan">
          <h4>Premium</h4>
          <p>‚Ç¶5,000 - ‚Ç¶50,000</p>
          <p class="muted small">ROI: 50%</p>
          <button class="btn btn-primary plan-btn" data-plan="premium">Choose Plan</button>
        </div>
        <div class="plan">
          <h4>Executive</h4>
          <p>‚Ç¶5,000 - ‚Ç¶500,000</p>
          <p class="muted small">ROI: 100%</p>
          <button class="btn btn-primary plan-btn" data-plan="executive">Choose Plan</button>
        </div>
      </div>

      <div class="deposit-box">
        <h3>Deposit Account Details</h3>
        <p><strong>Bank:</strong> Kuda Bank</p>
        <p><strong>Account Name:</strong> MUTECH INVESTMENT</p>
        <p><strong>Account Number:</strong> <span id="accountNumber">2014613557</span></p>
        <div class="deposit-actions">
          <button class="btn btn-primary" id="copyAccountBtn">Copy Account Number</button>
          <button class="btn btn-outline" id="submitProofBtn">Submit Proof</button>
        </div>
        <p id="copyMsg" class="muted small hidden mt-1">‚úì Copied to clipboard</p>
      </div>
    </div>
  </section>

  <section id="dashboardSection" class="hidden">
    <div class="card">
      <h2>Dashboard</h2>
      <div class="stats">
        <div class="stat-card">
          <div class="label">Wallet Balance</div>
          <div class="value" id="walletBalance">‚Ç¶0</div>
        </div>
        <div class="stat-card">
          <div class="label">Active Investments</div>
          <div class="value" id="activeInvestments">‚Ç¶0</div>
        </div>
        <div class="stat-card">
          <div class="label">Referral Earnings</div>
          <div class="value" id="referralEarnings">‚Ç¶0</div>
        </div>
      </div>

      <div class="deposit-actions">
        <button class="btn btn-primary" id="depositBtn">Deposit</button>
        <button class="btn btn-outline" id="withdrawBtn">Withdraw</button>
        <button class="btn btn-primary" id="investBtn">Invest</button>
        <button class="btn btn-ghost" id="referralBtn">Referral</button>
      </div>

      <h3 class="mt-1">Investment History</h3>
      <div class="table-wrap">
        <table>
          <thead>
            <tr>
              <th>Plan</th>
              <th>Amount</th>
              <th>ROI</th>
              <th>Date</th>
              <th>Status</th>
            </tr>
          </thead>
          <tbody id="investmentHistory"></tbody>
        </table>
      </div>
    </div>
  </section>

  <section id="adminSection" class="hidden">
    <div class="card">
      <h2>Admin Panel</h2>
      <div class="stats">
        <div class="stat-card">
          <div class="label">Total Users</div>
          <div class="value" id="totalUsers">0</div>
        </div>
        <div class="stat-card">
          <div class="label">Total Investments</div>
          <div class="value" id="totalInvestments">‚Ç¶0</div>
        </div>
        <div class="stat-card">
          <div class="label">Pending Deposits</div>
          <div class="value" id="pendingDepositsCount">0</div>
        </div>
      </div>

      <h3 class="mt-1">Pending Deposits</h3>
      <div id="pendingDepositsList"></div>

      <h3 class="mt-1">Pending Withdrawals</h3>
      <div id="pendingWithdrawalsList"></div>

      <h3 class="mt-1">Pending Investments</h3>
      <div id="pendingInvestmentsList"></div>

      <h3 class="mt-1">Registered Users</h3>
      <div id="usersList"></div>
    </div>
  </section>
</div>

<div id="loginModal" class="modal">
  <div class="modal-content">
    <div class="modal-header">
      <h3>Login</h3>
      <button class="close-btn" data-modal="loginModal">&times;</button>
    </div>
    <form id="loginForm">
      <div class="form-group">
        <label>Email</label>
        <input type="email" id="loginEmail" required>
      </div>
      <div class="form-group">
        <label>Password</label>
        <input type="password" id="loginPassword" required>
      </div>
      <button type="submit" class="btn btn-primary" style="width: 100%;">Login</button>
      <p class="muted small mt-1">Don't have an account? <a href="#" id="switchToRegister" style="color: var(--accent1);">Register here</a></p>
    </form>
  </div>
</div>

<div id="registerModal" class="modal">
  <div class="modal-content">
    <div class="modal-header">
      <h3>Register</h3>
      <button class="close-btn" data-modal="registerModal">&times;</button>
    </div>
    <form id="registerForm">
      <div class="form-group">
        <label>Email</label>
        <input type="email" id="registerEmail" required>
      </div>
      <div class="form-group">
        <label>Password</label>
        <input type="password" id="registerPassword" required>
      </div>
      <div class="form-group">
        <label>Referral Code (Optional)</label>
        <input type="text" id="referralCode">
      </div>
      <button type="submit" class="btn btn-primary" style="width: 100%;">Register</button>
      <p class="muted small mt-1">Already have an account? <a href="#" id="switchToLogin" style="color: var(--accent1);">Login here</a></p>
    </form>
  </div>
</div>

<div id="depositModal" class="modal">
  <div class="modal-content">
    <div class="modal-header">
      <h3>Submit Deposit Proof</h3>
      <button class="close-btn" data-modal="depositModal">&times;</button>
    </div>
    <p class="muted small">Transfer to: Kuda Bank ‚Ä¢ 2014613557 ‚Ä¢ MUTECH INVESTMENT</p>
    <div class="form-group">
      <label>Amount (‚Ç¶)</label>
      <input type="number" id="depositAmount" min="1" required>
    </div>
    <div class="form-group">
      <label>Upload Proof (Image)</label>
      <input type="file" id="depositProof" accept="image/*" required>
    </div>
    <div id="proofPreview" class="mt-1"></div>
    <button type="button" class="btn btn-primary" id="submitDepositBtn" style="width: 100%;">Submit Proof</button>
  </div>
</div>

<div id="withdrawModal" class="modal">
  <div class="modal-content">
    <div class="modal-header">
      <h3>Request Withdrawal</h3>
      <button class="close-btn" data-modal="withdrawModal">&times;</button>
    </div>
    <form id="withdrawForm">
      <div class="form-group">
        <label>Amount (‚Ç¶)</label>
        <input type="number" id="withdrawAmount" min="8000" required>
      </div>
      <div class="form-group">
        <label>Bank Name</label>
        <input type="text" id="bankName" required>
      </div>
      <div class="form-group">
        <label>Account Number</label>
        <input type="text" id="accountNum" required>
      </div>
      <div class="form-group">
        <label>Account Name</label>
        <input type="text" id="accountName" required>
      </div>
      <button type="submit" class="btn btn-primary" style="width: 100%;">Request Withdrawal</button>
    </form>
  </div>
</div>

<div id="investModal" class="modal">
  <div class="modal-content">
    <div class="modal-header">
      <h3>Make Investment</h3>
      <button class="close-btn" data-modal="investModal">&times;</button>
    </div>
    <form id="investForm">
      <div class="form-group">
        <label>Plan</label>
        <select id="investPlan" required>
          <option value="starter">Starter (‚Ç¶5K-10K, 20% ROI)</option>
          <option value="premium">Premium (‚Ç¶5K-50K, 50% ROI)</option>
          <option value="executive">Executive (‚Ç¶5K-500K, 100% ROI)</option>
        </select>
      </div>
      <div class="form-group">
        <label>Amount (‚Ç¶)</label>
        <input type="number" id="investAmount" min="5000" required>
      </div>
      <button type="submit" class="btn btn-primary" style="width: 100%;">Invest Now</button>
    </form>
  </div>
</div>

<div id="referralModal" class="modal">
  <div class="modal-content">
    <div class="modal-header">
      <h3>Referral Program</h3>
      <button class="close-btn" data-modal="referralModal">&times;</button>
    </div>
    <div class="form-group">
      <label>Your Referral Link</label>
      <input type="text" id="referralLink" readonly>
    </div>
    <button type="button" class="btn btn-primary" id="copyReferralBtn" style="width: 100%;">Copy Link</button>
    <div class="mt-1">
      <p>Total Earnings: <strong id="referralTotal">‚Ç¶0</strong></p>
      <p>Total Referrals: <strong id="referralCount">0</strong></p>
    </div>
  </div>
</div>

<script>
(function() {
  'use strict';
  
  console.log('Script starting...');

  const STORAGE_KEYS = {
    users: 'mutech_users',
    deposits: 'mutech_deposits',
    withdrawals: 'mutech_withdrawals',
    pendingInvestments: 'mutech_pending_investments',
    currentUser: 'mutech_current_user'
  };

  function initStorage() {
    console.log('Initializing storage...');
    if (!localStorage.getItem(STORAGE_KEYS.users)) {
      const initialUsers = {
        'declantessa@gmail.com': {
          email: 'declantessa@gmail.com',
          password: 'BAMIDELE!1',
          wallet: 0,
          investments: [],
          referralCode: 'ADMIN001',
          referralEarnings: 0,
          referredBy: null,
          isAdmin: true
        }
      };
      localStorage.setItem(STORAGE_KEYS.users, JSON.stringify(initialUsers));
      console.log('Admin account created');
    }
    if (!localStorage.getItem(STORAGE_KEYS.deposits)) {
      localStorage.setItem(STORAGE_KEYS.deposits, JSON.stringify([]));
    }
    if (!localStorage.getItem(STORAGE_KEYS.withdrawals)) {
      localStorage.setItem(STORAGE_KEYS.withdrawals, JSON.stringify([]));
    }
    if (!localStorage.getItem(STORAGE_KEYS.pendingInvestments)) {
      localStorage.setItem(STORAGE_KEYS.pendingInvestments, JSON.stringify([]));
    }
  }

  function getUsers() {
    return JSON.parse(localStorage.getItem(STORAGE_KEYS.users)) || {};
  }

  function saveUsers(users) {
    localStorage.setItem(STORAGE_KEYS.users, JSON.stringify(users));
  }

  function getDeposits() {
    return JSON.parse(localStorage.getItem(STORAGE_KEYS.deposits)) || [];
  }

  function saveDeposits(deposits) {
    localStorage.setItem(STORAGE_KEYS.deposits, JSON.stringify(deposits));
  }

  function getWithdrawals() {
    return JSON.parse(localStorage.getItem(STORAGE_KEYS.withdrawals)) || [];
  }

  function saveWithdrawals(withdrawals) {
    localStorage.setItem(STORAGE_KEYS.withdrawals, JSON.stringify(withdrawals));
  }

  function getPendingInvestments() {
    return JSON.parse(localStorage.getItem(STORAGE_KEYS.pendingInvestments)) || [];
  }

  function savePendingInvestments(list) {
    localStorage.setItem(STORAGE_KEYS.pendingInvestments, JSON.stringify(list));
  }

  function getCurrentUser() {
    return localStorage.getItem(STORAGE_KEYS.currentUser);
  }

  function setCurrentUser(email) {
    localStorage.setItem(STORAGE_KEYS.currentUser, email);
  }

  function clearCurrentUser() {
    localStorage.removeItem(STORAGE_KEYS.currentUser);
  }

  // Theme toggle
  const themeToggle = document.getElementById('themeToggle');
  themeToggle.addEventListener('click', function() {
    console.log('Theme toggle clicked');
    document.body.classList.toggle('light-mode');
    themeToggle.textContent = document.body.classList.contains('light-mode') ? '‚òÄÔ∏è' : 'üåô';
  });

  // Modal controls
  document.querySelectorAll('.close-btn').forEach(function(btn) {
    btn.addEventListener('click', function() {
      console.log('Close button clicked');
      const modalId = btn.getAttribute('data-modal');
      document.getElementById(modalId).classList.remove('active');
    });
  });

  document.querySelectorAll('.modal').forEach(function(modal) {
    modal.addEventListener('click', function(e) {
      if (e.target === modal) {
        modal.classList.remove('active');
      }
    });
  });

  // Auth buttons
  document.getElementById('loginBtn').addEventListener('click', function() {
    console.log('Login button clicked');
    document.getElementById('loginModal').classList.add('active');
  });

  document.getElementById('registerBtn').addEventListener('click', function() {
    console.log('Register button clicked');
    document.getElementById('registerModal').classList.add('active');
  });

  document.getElementById('switchToRegister').addEventListener('click', function(e) {
    e.preventDefault();
    console.log('Switching to register');
    document.getElementById('loginModal').classList.remove('active');
    document.getElementById('registerModal').classList.add('active');
  });

  document.getElementById('switchToLogin').addEventListener('click', function(e) {
    e.preventDefault();
    console.log('Switching to login');
    document.getElementById('registerModal').classList.remove('active');
    document.getElementById('loginModal').classList.add('active');
  });

  // Register form
  const registerForm = document.getElementById('registerForm');
  if (registerForm) {
    registerForm.addEventListener('submit', function(e) {
      e.preventDefault();
      e.stopPropagation();
      console.log('Register form submitted');
      
      const emailInput = document.getElementById('registerEmail');
      const passwordInput = document.getElementById('registerPassword');
      const referralInput = document.getElementById('referralCode');
      
      const email = emailInput.value.toLowerCase().trim();
      const password = passwordInput.value;
      const referralCode = referralInput.value.trim();

      console.log('Registering user:', email);

      if (!email || !password) {
        alert('Please fill in all required fields!');
        return false;
      }

      const users = getUsers();
      
      if (users[email]) {
        alert('User already exists! Please login instead.');
        document.getElementById('registerModal').classList.remove('active');
        document.getElementById('loginModal').classList.add('active');
        return false;
      }

      const newUser = {
        email: email,
        password: password,
        wallet: 1000,
        investments: [],
        referralCode: Math.random().toString(36).substring(2, 8).toUpperCase(),
        referralEarnings: 0,
        referredBy: referralCode || null,
        isAdmin: false
      };

      if (referralCode) {
        const referrer = Object.values(users).find(function(u) { return u.referralCode === referralCode; });
        if (referrer) {
          referrer.referralEarnings += 200;
          referrer.wallet += 200;
          users[referrer.email] = referrer;
          newUser.wallet += 200;
        }
      }

      users[email] = newUser;
      saveUsers(users);
      
      console.log('User registered successfully');
      
      // Auto login
      setCurrentUser(email);
      document.getElementById('registerModal').classList.remove('active');
      registerForm.reset();
      
      alert('Registration successful! Welcome to MUTECH!');
      
      // Load dashboard
      setTimeout(function() {
        loadDashboard();
      }, 100);
      
      return false;
    });
  }

  // Login form
  const loginForm = document.getElementById('loginForm');
  if (loginForm) {
    loginForm.addEventListener('submit', function(e) {
      e.preventDefault();
      e.stopPropagation();
      console.log('Login form submitted');
      
      const emailInput = document.getElementById('loginEmail');
      const passwordInput = document.getElementById('loginPassword');
      
      const email = emailInput.value.toLowerCase().trim();
      const password = passwordInput.value;

      console.log('Logging in:', email);

      if (!email || !password) {
        alert('Please enter both email and password!');
        return false;
      }

      const users = getUsers();
      const user = users[email];

      if (user && user.password === password) {
        console.log('Login successful');
        setCurrentUser(email);
        
        document.getElementById('loginModal').classList.remove('active');
        loginForm.reset();
        
        if (user.isAdmin === true) {
          console.log('Loading admin panel');
          alert('Welcome Admin!');
          setTimeout(function() {
            loadAdminPanel();
          }, 100);
        } else {
          console.log('Loading dashboard');
          alert('Welcome back!');
          setTimeout(function() {
            loadDashboard();
          }, 100);
        }
      } else {
        alert('Invalid email or password! Please try again.');
      }
      
      return false;
    });
  }

  // Logout
  document.getElementById('logoutBtn').addEventListener('click', function() {
    console.log('Logout clicked');
    clearCurrentUser();
    location.reload();
  });

  function loadDashboard() {
    console.log('Loading dashboard...');
    const email = getCurrentUser();
    const users = getUsers();
    const user = users[email];

    if (!user) {
      console.error('User not found');
      return;
    }

    document.getElementById('authButtons').classList.add('hidden');
    document.getElementById('userInfo').classList.remove('hidden');
    document.getElementById('username').textContent = email;
    document.getElementById('landingSection').classList.add('hidden');
    document.getElementById('dashboardSection').classList.remove('hidden');
    document.getElementById('adminSection').classList.add('hidden');
    document.getElementById('adminBtn').classList.add('hidden');

    document.getElementById('walletBalance').textContent = '‚Ç¶' + user.wallet.toLocaleString();
    const totalInvested = user.investments.reduce(function(sum, inv) { return sum + inv.amount; }, 0);
    document.getElementById('activeInvestments').textContent = '‚Ç¶' + totalInvested.toLocaleString();
    document.getElementById('referralEarnings').textContent = '‚Ç¶' + user.referralEarnings.toLocaleString();

    const tbody = document.getElementById('investmentHistory');
    tbody.innerHTML = '';
    user.investments.forEach(function(inv) {
      const tr = document.createElement('tr');
      tr.innerHTML = '<td>' + inv.plan.charAt(0).toUpperCase() + inv.plan.slice(1) + '</td><td>‚Ç¶' + inv.amount.toLocaleString() + '</td><td>' + inv.roi + '%</td><td>' + inv.date + '</td><td>' + inv.status + '</td>';
      tbody.appendChild(tr);
    });

    console.log('Dashboard loaded successfully');
  }

  function loadAdminPanel() {
    console.log('Loading admin panel...');
    const email = getCurrentUser();
    const allUsers = getUsers();
    const user = allUsers[email];
    
    if (!user || !user.isAdmin) {
      alert('Access denied!');
      clearCurrentUser();
      location.reload();
      return;
    }

    document.getElementById('authButtons').classList.add('hidden');
    document.getElementById('userInfo').classList.remove('hidden');
    document.getElementById('username').textContent = 'Admin';
    document.getElementById('landingSection').classList.add('hidden');
    document.getElementById('dashboardSection').classList.add('hidden');
    document.getElementById('adminSection').classList.remove('hidden');
    document.getElementById('adminBtn').classList.remove('hidden');

    const deposits = getDeposits();
    const withdrawals = getWithdrawals();
    const pendingInvestments = getPendingInvestments();

    document.getElementById('totalUsers').textContent = Object.keys(allUsers).length;
    const totalInv = Object.values(allUsers).reduce(function(sum, u) {
      return sum + (u.investments || []).reduce(function(s, inv) { return s + inv.amount; }, 0);
    }, 0);
    document.getElementById('totalInvestments').textContent = '‚Ç¶' + totalInv.toLocaleString();
    document.getElementById('pendingDepositsCount').textContent = deposits.filter(function(d) { return d.status === 'pending'; }).length;

    const depositsList = document.getElementById('pendingDepositsList');
    depositsList.innerHTML = '';
    deposits.filter(function(d) { return d.status === 'pending'; }).forEach(function(deposit, idx) {
      const div = document.createElement('div');
      div.className = 'admin-item';
      div.innerHTML = '<p><strong>' + deposit.email + '</strong></p><p>Amount: ‚Ç¶' + deposit.amount.toLocaleString() + '</p><p class="small muted">' + deposit.date + '</p>' + (deposit.proofData ? '<img src="' + deposit.proofData + '" style="max-width: 200px; border-radius: 8px; margin: 0.5rem 0;">' : '') + '<div class="admin-actions"><button class="btn btn-primary" onclick="approveDeposit(' + idx + ')">Approve</button><button class="btn btn-outline" onclick="rejectDeposit(' + idx + ')">Reject</button></div>';
      depositsList.appendChild(div);
    });

    const withdrawalsList = document.getElementById('pendingWithdrawalsList');
    withdrawalsList.innerHTML = '';
    withdrawals.filter(function(w) { return w.status === 'pending'; }).forEach(function(withdrawal, idx) {
      const div = document.createElement('div');
      div.className = 'admin-item';
      div.innerHTML = '<p><strong>' + withdrawal.email + '</strong></p><p>Amount: ‚Ç¶' + withdrawal.amount.toLocaleString() + '</p><p>Bank: ' + withdrawal.bankName + '</p><p>Account: ' + withdrawal.accountNumber + ' - ' + withdrawal.accountName + '</p><p class="small muted">' + withdrawal.date + '</p><div class="admin-actions"><button class="btn btn-primary" onclick="approveWithdrawal(' + idx + ')">Approve</button></div>';
      withdrawalsList.appendChild(div);
    });

    const pendingInvestmentsList = document.getElementById('pendingInvestmentsList');
    pendingInvestmentsList.innerHTML = '';
    pendingInvestments.filter(function(p) { return p.status === 'pending'; }).forEach(function(pending, idx) {
      const div = document.createElement('div');
      div.className = 'admin-item';
      div.innerHTML = '<p><strong>' + pending.email + '</strong></p><p>Plan: ' + pending.plan.charAt(0).toUpperCase() + pending.plan.slice(1) + '</p><p>Amount: ‚Ç¶' + pending.amount.toLocaleString() + '</p><p class="small muted">' + pending.date + '</p><div class="admin-actions"><button class="btn btn-primary" onclick="approveInvestment(' + idx + ')">Approve</button><button class="btn btn-outline" onclick="rejectInvestment(' + idx + ')">Reject</button></div>';
      pendingInvestmentsList.appendChild(div);
    });

    // Show all users with passwords
    const usersList = document.getElementById('usersList');
    usersList.innerHTML = '';

    Object.values(allUsers).forEach(function(u) {
      const div = document.createElement('div');
      div.className = 'admin-item';
      div.innerHTML = `
        <p><strong>${u.email}</strong></p>
        <p>Password: <strong>${u.password}</strong></p>
        <p>Wallet: ‚Ç¶${u.wallet.toLocaleString()}</p>
        <p>Referral Code: ${u.referralCode}</p>
        <p>Referral Earnings: ‚Ç¶${u.referralEarnings.toLocaleString()}</p>
        <p>Total Investments: ${u.investments.length}</p>
      `;
      usersList.appendChild(div);
    });

    console.log('Admin panel loaded successfully');
  }

  window.approveDeposit = function(idx) {
    console.log('Approving deposit:', idx);
    const deposits = getDeposits();
    const deposit = deposits[idx];
    
    if (deposit.status !== 'pending') return;
    
    const users = getUsers();
    if (users[deposit.email]) {
      users[deposit.email].wallet += deposit.amount;
      saveUsers(users);
    }
    
    deposits[idx].status = 'approved';
    saveDeposits(deposits);
    
    alert('Deposit approved!');
    loadAdminPanel();
  };

  window.rejectDeposit = function(idx) {
    console.log('Rejecting deposit:', idx);
    const deposits = getDeposits();
    deposits[idx].status = 'rejected';
    saveDeposits(deposits);
    
    alert('Deposit rejected!');
    loadAdminPanel();
  };

  window.approveWithdrawal = function(idx) {
    console.log('Approving withdrawal:', idx);
    const withdrawals = getWithdrawals();
    withdrawals[idx].status = 'approved';
    saveWithdrawals(withdrawals);
    
    alert('Withdrawal approved!');
    loadAdminPanel();
  };

  // Investment approval handlers
  window.approveInvestment = function(idx) {
    console.log('Approving investment:', idx);
    const pending = getPendingInvestments();
    if (!pending[idx] || pending[idx].status !== 'pending') return;

    const invest = pending[idx];
    const users = getUsers();

    if (users[invest.email]) {
      // Move to user's investments as active
      const invObj = {
        plan: invest.plan,
        amount: invest.amount,
        roi: invest.roi,
        date: new Date().toLocaleDateString(),
        status: 'Active'
      };
      users[invest.email].investments.push(invObj);
      saveUsers(users);

      pending[idx].status = 'approved';
      savePendingInvestments(pending);

      alert('Investment approved and activated!');
      loadAdminPanel();
    } else {
      alert('User not found for this investment.');
    }
  };

  window.rejectInvestment = function(idx) {
    console.log('Rejecting investment:', idx);
    const pending = getPendingInvestments();
    if (!pending[idx] || pending[idx].status !== 'pending') return;

    const invest = pending[idx];
    const users = getUsers();

    if (users[invest.email]) {
      // refund amount to user wallet
      users[invest.email].wallet += invest.amount;
      saveUsers(users);

      pending[idx].status = 'rejected';
      savePendingInvestments(pending);

      alert('Investment rejected. Amount refunded to user wallet.');
      loadAdminPanel();
    } else {
      alert('User not found for this investment.');
    }
  };

  // Dashboard action buttons
  document.getElementById('depositBtn').addEventListener('click', function() {
    console.log('Deposit button clicked');
    document.getElementById('depositModal').classList.add('active');
  });

  document.getElementById('submitProofBtn').addEventListener('click', function() {
    console.log('Submit proof button clicked');
    const currentUser = getCurrentUser();
    if (!currentUser) {
      alert('Please login first!');
      document.getElementById('loginModal').classList.add('active');
      return;
    }
    document.getElementById('depositModal').classList.add('active');
  });

  document.getElementById('withdrawBtn').addEventListener('click', function() {
    console.log('Withdraw button clicked');
    document.getElementById('withdrawModal').classList.add('active');
  });

  document.getElementById('investBtn').addEventListener('click', function() {
    console.log('Invest button clicked');
    document.getElementById('investModal').classList.add('active');
  });

  document.getElementById('referralBtn').addEventListener('click', function() {
    console.log('Referral button clicked');
    const email = getCurrentUser();
    const users = getUsers();
    const user = users[email];
    
    document.getElementById('referralLink').value = window.location.origin + window.location.pathname + '?ref=' + user.referralCode;
    document.getElementById('referralTotal').textContent = '‚Ç¶' + user.referralEarnings.toLocaleString();
    
    const referralCount = Object.values(users).filter(function(u) { return u.referredBy === user.referralCode; }).length;
    document.getElementById('referralCount').textContent = referralCount;
    
    document.getElementById('referralModal').classList.add('active');
  });

  // Plan buttons
  document.querySelectorAll('.plan-btn').forEach(function(btn) {
    btn.addEventListener('click', function() {
      console.log('Plan button clicked');
      const currentUser = getCurrentUser();
      if (!currentUser) {
        alert('Please login first to choose a plan!');
        document.getElementById('loginModal').classList.add('active');
        return;
      }
      const plan = btn.getAttribute('data-plan');
      document.getElementById('investPlan').value = plan;
      document.getElementById('investModal').classList.add('active');
    });
  });

  // Copy account number
  document.getElementById('copyAccountBtn').addEventListener('click', function() {
    console.log('Copy account button clicked');
    const accountNumber = document.getElementById('accountNumber').textContent;
    navigator.clipboard.writeText(accountNumber).then(function() {
      const msg = document.getElementById('copyMsg');
      msg.classList.remove('hidden');
      setTimeout(function() { msg.classList.add('hidden'); }, 2000);
    });
  });

  // Copy referral link
  document.getElementById('copyReferralBtn').addEventListener('click', function() {
    console.log('Copy referral button clicked');
    const link = document.getElementById('referralLink');
    link.select();
    navigator.clipboard.writeText(link.value).then(function() {
      alert('Referral link copied!');
    });
  });

  // Deposit proof preview
  document.getElementById('depositProof').addEventListener('change', function(e) {
    const file = e.target.files[0];
    if (file) {
      const reader = new FileReader();
      reader.onload = function(event) {
        const preview = document.getElementById('proofPreview');
        preview.innerHTML = '<img src="' + event.target.result + '" style="max-width: 100%; border-radius: 8px; border: 1px solid rgba(255,255,255,0.2);">';
      };
      reader.readAsDataURL(file);
    }
  });

  // Submit deposit
  document.getElementById('submitDepositBtn').addEventListener('click', function() {
    console.log('Submit deposit button clicked');
    const amount = parseFloat(document.getElementById('depositAmount').value);
    const proofFile = document.getElementById('depositProof').files[0];
    
    if (!amount || amount <= 0) {
      alert('Please enter a valid amount!');
      return;
    }
    
    if (!proofFile) {
      alert('Please upload proof of payment!');
      return;
    }
    
    const email = getCurrentUser();
    if (!email) {
      alert('Please login first!');
      document.getElementById('depositModal').classList.remove('active');
      document.getElementById('loginModal').classList.add('active');
      return;
    }

    const reader = new FileReader();
    
    reader.onload = function(e) {
      const deposits = getDeposits();
      deposits.push({
        email: email,
        amount: amount,
        proofData: e.target.result,
        date: new Date().toLocaleString(),
        status: 'pending'
      });
      saveDeposits(deposits);
      
      alert('Deposit proof submitted! Waiting for admin approval.');
      document.getElementById('depositModal').classList.remove('active');
      document.getElementById('depositAmount').value = '';
      document.getElementById('depositProof').value = '';
      document.getElementById('proofPreview').innerHTML = '';
    };
    
    reader.readAsDataURL(proofFile);
  });

  // Withdraw form
  document.getElementById('withdrawForm').addEventListener('submit', function(e) {
    e.preventDefault();
    console.log('Withdraw form submitted');
    
    const amount = parseFloat(document.getElementById('withdrawAmount').value);
    const bankName = document.getElementById('bankName').value;
    const accountNumber = document.getElementById('accountNum').value;
    const accountName = document.getElementById('accountName').value;
    
    if (amount < 8000) {
      alert('Minimum withdrawal is ‚Ç¶8,000');
      return;
    }
    
    const email = getCurrentUser();
    const users = getUsers();
    const user = users[email];
    
    if (amount > user.wallet) {
      alert('Insufficient balance!');
      return;
    }
    
    user.wallet -= amount;
    users[email] = user;
    saveUsers(users);
    
    const withdrawals = getWithdrawals();
    withdrawals.push({
      email: email,
      amount: amount,
      bankName: bankName,
      accountNumber: accountNumber,
      accountName: accountName,
      date: new Date().toLocaleDateString(),
      status: 'pending'
    });
    saveWithdrawals(withdrawals);
    
    alert('Withdrawal request submitted!');
    document.getElementById('withdrawModal').classList.remove('active');
    document.getElementById('withdrawForm').reset();
    loadDashboard();
  });

  // Invest form
  document.getElementById('investForm').addEventListener('submit', function(e) {
    e.preventDefault();
    console.log('Invest form submitted');
    
    const plan = document.getElementById('investPlan').value;
    const amount = parseFloat(document.getElementById('investAmount').value);
    
    const planDetails = {
      starter: { min: 5000, max: 10000, roi: 20 },
      premium: { min: 5000, max: 50000, roi: 50 },
      executive: { min: 5000, max: 500000, roi: 100 }
    };
    
    const details = planDetails[plan];
    
    if (!details) {
      alert('Invalid plan selected');
      return;
    }
    
    if (amount < details.min || amount > details.max) {
      alert('Amount must be between ‚Ç¶' + details.min.toLocaleString() + ' and ‚Ç¶' + details.max.toLocaleString());
      return;
    }
    
    const email = getCurrentUser();
    const users = getUsers();
    const user = users[email];
    
    if (!user) {
      alert('Please login first!');
      return;
    }
    
    if (amount > user.wallet) {
      alert('Insufficient balance!');
      return;
    }
    
    // Deduct immediately but mark investment as pending until admin approves
    user.wallet -= amount;
    users[email] = user;
    saveUsers(users);

    const pending = getPendingInvestments();
    pending.push({
      email: email,
      plan: plan,
      amount: amount,
      roi: details.roi,
      date: new Date().toLocaleString(),
      status: 'pending'
    });
    savePendingInvestments(pending);
    
    alert('Investment submitted for admin approval!');
    document.getElementById('investModal').classList.remove('active');
    document.getElementById('investForm').reset();
    loadDashboard();
  });

  // Admin panel toggle
  document.getElementById('adminBtn').addEventListener('click', function() {
    console.log('Admin button clicked');
    loadAdminPanel();
  });

  // Initialize
  initStorage();
  console.log('Storage initialized');

  // Check if user is logged in
  const currentUser = getCurrentUser();
  if (currentUser) {
    console.log('User already logged in:', currentUser);
    const users = getUsers();
    const user = users[currentUser];
    
    if (user && user.isAdmin === true) {
      loadAdminPanel();
    } else if (user) {
      loadDashboard();
    }
  } else {
    console.log('No user logged in');
  }

  console.log('Script loaded successfully!');
})();
</script>

</body>
            </html>
